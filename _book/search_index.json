[
["index.html", "A Report Example 1 Prerequsites", " A Report Example Bo Sun 2017-11-19 1 Prerequsites For now, you have to install the development versions of bookdown from Github: devtools::install_github(&quot;rstudio/bookdown&quot;) "],
["t-sne-analysis.html", "2 t-SNE analysis 2.1 Dataset Human 2.2 Dataset Mouse", " 2 t-SNE analysis 2.1 Dataset Human total 163 columns rpkm data kidney 20, 41, 42 miss 1 year kidney 29 miss pre kidney 19 miss 3 months tbl &lt;- tbl_df(tsne$Y) tbl$persons = persons tbl$time_point = Labels tbl %&gt;% ggplot(aes(x = V1, y = V2, label = persons, col = time_point)) + geom_text() Figure 2.1: Similarity between samples and time points(backgroud deducted). In figure 2.1: pre expression profile(\\(log(FPKM + 1)\\)) was deducted from post, 1 year, and 3 months. And then the dimension reduction was done using t-SNE algorithm. The plot makes more sense now: later time points(3 months, 1 year) stick together and are separated from post points, upon which a Pseudotime Sample Trajectory was constructed by means of Monocle 2. 2.2 Dataset Mouse ## Read the 49 x 49 data matrix successfully! ## Using no_dims = 2, perplexity = 9.000000, and theta = 0.500000 ## Computing input similarities... ## Normalizing input... ## Building tree... ## - point 0 of 49 ## Done in 0.00 seconds (sparsity = 0.670554)! ## Learning embedding... ## Iteration 50: error is 56.664756 (50 iterations in 0.01 seconds) ## Iteration 100: error is 51.474400 (50 iterations in 0.01 seconds) ## Iteration 150: error is 56.221535 (50 iterations in 0.01 seconds) ## Iteration 200: error is 54.908899 (50 iterations in 0.01 seconds) ## Iteration 250: error is 56.325644 (50 iterations in 0.01 seconds) ## Iteration 300: error is 1.607589 (50 iterations in 0.01 seconds) ## Iteration 350: error is 0.545783 (50 iterations in 0.00 seconds) ## Iteration 400: error is 0.351512 (50 iterations in 0.00 seconds) ## Iteration 450: error is 0.204200 (50 iterations in 0.01 seconds) ## Iteration 500: error is 0.186298 (50 iterations in 0.01 seconds) ## Fitting performed in 0.06 seconds. Figure 2.2: Same t-SNE analysis for mouse data. As shown in the Figure 2.2: The syntaxis of same time-point and same mouse-type are stronger in this Mouse data, though it has less sample points here–49 samples in total, divided into three types(IRI, NORM, SHAM), each time point with 3 replicate except for 6mN has 4. The perplexity = 9 and set.seed(81) were tuned mannualy by hands-and-eyes. Based on tens of runs, the results are alike–the clustering is good. Perplexity &gt;5 and &lt;= 10 generally works here for limitied times of run done by myself. "],
["quality-control.html", "3 Quality Control 3.1 gene filtering 3.2 check log-nomality", " 3 Quality Control Note that Monocle assume the gene expresison is log-normally distributed. So here we perform some filtering and then give it a check..1 And it won’t intervere following analysis since in this bulk analysis, we are not facing issues of Single-Cell protocol like low mRNA cell sample or doublets or triplets, etc. 3.1 gene filtering human &lt;- detectGenes(human, min_expr = 0.1) plot(density(fData(human)$num_cells_expressed)) The number of cells express a certain gene is bimodal distributed, for \\(threshold = .1\\), some genes are expressed in all 163 samples, and some genes are only expressed in a little few samples. expressed.gene &lt;- row.names(subset(fData(human), num_cells_expressed &gt;= 50)) Genes has &gt;= 50 samples with \\(RPKM &gt;= .1\\) are kept. (22047/54514 genes left) 3.2 check log-nomality As suggest in Monocle mannual, take log(rpkm + 1), scale each log-transformed gene expression(subtract the mean and divided by \\(sd\\)), make the whole log-rpkm matrix a single vector then compare it to a standard normal. L &lt;- log(exprs(human[expressed.gene,]) + 1) Apparently, our filtered data pass the log-normality test. Monocle is tuned for Single-Cell RNA-seq, so does the quality control described in the Recommended Analysis Protocol↩ "],
["pseudo-time-trajectory-prediction.html", "4 Pseudo-time trajectory prediction 4.1 Step 1-2: Set ordering genes and reduce demisionality 4.2 Step 3: ordering the cells in pseudotime", " 4 Pseudo-time trajectory prediction 4.1 Step 1-2: Set ordering genes and reduce demisionality &quot; Monocle looks for genes that vary in “interesting” (i.e. not just noisy) ways, and uses these to structure the data.&quot; — Monocle Mannual This is the feature selection step in the Monocle’s machine learning algorithm for this job, which has major impact of the shape of the trajectory to be constructed. diff_test_res &lt;- differentialGeneTest(human[expressed.gene,], fullModelFormulaStr = &quot;~time&quot;) ordering_genes &lt;- row.names (subset(diff_test_res, qval &lt; 0.01)) ordering_genes &lt;- intersect(ordering_genes, expressed.gene) human &lt;- setOrderingFilter(human, ordering_genes) human &lt;- reduceDimension(human, max_components = 2, method = &#39;DDRTree&#39;) human &lt;- orderCells(human) 17985 of 22047 genes left. (The 22047 genes are the genes that express “interestingly” as described in Section 3.1). 4.2 Step 3: ordering the cells in pseudotime plot_cell_trajectory(human, color_by = &quot;time&quot;) plot_cell_trajectory(human, color_by = &quot;Pseudotime&quot;) Figure 4.1: Same trajectory colored by Pseudotime Monocle doesn’t know a priori which of the trajectory of the tree to call the “beginning”. So the Pseudotime is plotted reversly. It’s a little bit tricky to make it right. But in our case, it’s clear that the left is beginning and the right is end since the left points are pre and right points are post, as suggested in the previous figuer. I don’t know how to add labels to this figure since it was plotted by Monocle built-in functions. And it will also be messy on the plot. So a table will be good? knitr::kable( pData(human)[,c(&quot;person&quot;, &quot;time&quot;, &quot;Pseudotime&quot;)], booktabs = TRUE, caption = &#39;A table of the Pseudotime generated&#39; ) Table 4.1: A table of the Pseudotime generated person time Pseudotime sample.kidney_01_baseline_post 01 baseline_post 16.343957 sample.kidney_01_baseline_pre 01 baseline_pre 18.759666 sample.kidney_02_baseline_post 02 baseline_post 15.905122 sample.kidney_02_baseline_pre 02 baseline_pre 23.558735 sample.kidney_03_baseline_post 03 baseline_post 15.546759 sample.kidney_03_baseline_pre 03 baseline_pre 23.977949 sample.kidney_04_baseline_post 04 baseline_post 3.471537 sample.kidney_04_baseline_pre 04 baseline_pre 37.794212 sample.kidney_05_baseline_post 05 baseline_post 19.294851 sample.kidney_05_baseline_pre 05 baseline_pre 37.268242 sample.kidney_06_baseline_post 06 baseline_post 19.417621 sample.kidney_06_baseline_pre 06 baseline_pre 36.971777 sample.kidney_07_baseline_post 07 baseline_post 0.000000 sample.kidney_07_baseline_pre 07 baseline_pre 36.049794 sample.kidney_08_baseline_post 08 baseline_post 19.006155 sample.kidney_08_baseline_pre 08 baseline_pre 20.959575 sample.kidney_09_baseline_post 09 baseline_post 2.493296 sample.kidney_09_baseline_pre 09 baseline_pre 36.291851 sample.kidney_10_baseline_post 10 baseline_post 3.972422 sample.kidney_10_baseline_pre 10 baseline_pre 37.515398 sample.kidney_11_baseline_post 11 baseline_post 14.915194 sample.kidney_11_baseline_pre 11 baseline_pre 26.426196 sample.kidney_12_baseline_post 12 baseline_post 15.076965 sample.kidney_12_baseline_pre 12 baseline_pre 37.998821 sample.kidney_13_baseline_post 13 baseline_post 4.481699 sample.kidney_13_baseline_pre 13 baseline_pre 26.022365 sample.kidney_14_baseline_post 14 baseline_post 15.254758 sample.kidney_14_baseline_pre 14 baseline_pre 37.207727 sample.kidney_15_baseline_post 15 baseline_post 13.139552 sample.kidney_15_baseline_pre 15 baseline_pre 37.565014 sample.kidney_16_baseline_post 16 baseline_post 23.509750 sample.kidney_16_baseline_pre 16 baseline_pre 38.203048 sample.kidney_17_baseline_post 17 baseline_post 4.411050 sample.kidney_17_baseline_pre 17 baseline_pre 37.731035 sample.kidney_18_baseline_post 18 baseline_post 14.734395 sample.kidney_18_baseline_pre 18 baseline_pre 34.592928 sample.kidney_19_baseline_post 19 baseline_post 3.049479 sample.kidney_19_baseline_pre 19 baseline_pre 37.095411 sample.kidney_20_baseline_post 20 baseline_post 16.851456 sample.kidney_20_baseline_pre 20 baseline_pre 31.596650 sample.kidney_21_baseline_post 21 baseline_post 3.494093 sample.kidney_21_baseline_pre 21 baseline_pre 36.670486 sample.kidney_22_baseline_post 22 baseline_post 3.542999 sample.kidney_22_baseline_pre 22 baseline_pre 28.310753 sample.kidney_23_baseline_post 23 baseline_post 3.524408 sample.kidney_23_baseline_pre 23 baseline_pre 37.322141 sample.kidney_24_baseline_post 24 baseline_post 11.445690 sample.kidney_24_baseline_pre 24 baseline_pre 28.211771 sample.kidney_25_baseline_post 25 baseline_post 11.453034 sample.kidney_25_baseline_pre 25 baseline_pre 24.934383 sample.kidney_26_baseline_post 26 baseline_post 28.857246 sample.kidney_26_baseline_pre 26 baseline_pre 27.860759 sample.kidney_27_baseline_post 27 baseline_post 14.729848 sample.kidney_27_baseline_pre 27 baseline_pre 35.940841 sample.kidney_28_baseline_post 28 baseline_post 14.675554 sample.kidney_28_baseline_pre 28 baseline_pre 28.178635 sample.kidney_29_baseline_post 29 baseline_post 28.788652 sample.kidney_30_baseline_post 30 baseline_post 18.839448 sample.kidney_30_baseline_pre 30 baseline_pre 24.448409 sample.kidney_31_baseline_post 31 baseline_post 4.439941 sample.kidney_31_baseline_pre 31 baseline_pre 35.922339 sample.kidney_32_baseline_post 32 baseline_post 4.611549 sample.kidney_32_baseline_pre 32 baseline_pre 30.455091 sample.kidney_33_baseline_post 33 baseline_post 15.234127 sample.kidney_33_baseline_pre 33 baseline_pre 25.032899 sample.kidney_34_baseline_post 34 baseline_post 4.359224 sample.kidney_34_baseline_pre 34 baseline_pre 30.551365 sample.kidney_35_baseline_post 35 baseline_post 6.274882 sample.kidney_35_baseline_pre 35 baseline_pre 30.838598 sample.kidney_36_baseline_post 36 baseline_post 4.345997 sample.kidney_36_baseline_pre 36 baseline_pre 36.929690 sample.kidney_37_baseline_post 37 baseline_post 20.928901 sample.kidney_37_baseline_pre 37 baseline_pre 35.107001 sample.kidney_38_baseline_post 38 baseline_post 14.790778 sample.kidney_38_baseline_pre 38 baseline_pre 33.732354 sample.kidney_39_baseline_post 39 baseline_post 17.537571 sample.kidney_39_baseline_pre 39 baseline_pre 30.476172 sample.kidney_40_baseline_post 40 baseline_post 3.428423 sample.kidney_40_baseline_pre 40 baseline_pre 28.065158 sample.kidney_41_baseline_post 41 baseline_post 10.472033 sample.kidney_41_baseline_pre 41 baseline_pre 27.043803 sample.kidney_42_baseline_post 42 baseline_post 15.210156 sample.kidney_42_baseline_pre 42 baseline_pre 24.953453 "]
]
